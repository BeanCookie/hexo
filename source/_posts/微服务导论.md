---
title: 微服务导论
date: 2020-04-20 18:53:59
categories:
- 分布式
tags:
- 微服务
---
# 微服务导论

### 什么是微服务

> ​	当我们描述一个具体事物时其实很容易给出定义，比如我们可以外形的角度来描述什么是“猫”：*头圆、颜面部短，前肢五指，后肢四趾，趾端具锐利而弯曲的爪，爪能伸缩*。我们甚至可以拿出照片来解释这就是猫。与之相反我们很难描述一个抽象事物，比如我们很难解释什么是“爱情”，生活中我们可以用类比的方式来描述什么一个抽象事物，比如说“爱情”像什么什么一样。但是当描述一种全新的技术术语时我们却依然难以通过类比的方式进行描述。

#### 微服务不是什么

微服务并不是一个框架更不是某种特定编程语言实现的框架

#### 扩展立方体和服务

​	于是我们换一种角度，在这里我们引入一种叫做[**扩展立方体**](https://akfpartners.com/growth-blog/scale-cube)的三维可扩展模型。这个模型描述了扩展应用程序的三种维度。

- X轴扩展：在多个实例之间实现请求的负载均衡
- Z轴扩展：根据请求的属性路由请求
- Y轴扩展：根据功能把应用拆分为服务

![https://beancookie.github.io/images/微服务导论-01.png](https://beancookie.github.io/images/微服务导论-01.png)

所谓**服务**就是实现了一组相关的功能，并且能够在需要的时候借助X轴或Z轴进行扩展。

**微服务就是把应用程序功能性分解为一组服务的架构风格**

#### 微服务作为模块化的一种形式

​	在单体应用中模块化通常由编程语言(Package)或者编程语言配套(Maven，NPM，Composer)的包管理工具支持。但是随着时间的推移不断地进行版本迭代，单体应用会变得越来越庞大，越来越错综复杂。微服务使用服务而不是Package作为模块化的单元，服务的API定义了服务的边界。

#### 每个服务都拥有自己的数据库

​	微服务的一个关键特性是每个服务之间都是松耦合的，这种松耦合不仅仅是开发角度的，更是测试和运维角度的松耦合。

### 当谈论微服务时我们在谈论些什么

​	微服务早在2014年就被[Martin Fowler](https://zh.wikipedia.org/wiki/%E9%A9%AC%E4%B8%81%C2%B7%E7%A6%8F%E5%8B%92)提出，实际上软件行业从来都不缺新概念和新技术。很多人都图示寻找某种银弹来解决问题，但是很多概念都会和[光环曲线](https://wiki.mbalib.com/wiki/%E5%85%89%E7%8E%AF%E6%9B%B2%E7%BA%BF)一样消沉在历史长河之中。无数的新概念都会在过热期被大家广泛讨论和极致吹捧，2016年[AlphaGo](https://zh.wikipedia.org/wiki/AlphaGo)以4:1的战绩碾压李世石，2017又零封柯洁，媒体和民众甚至以为AI纪年已经到来。但是到了2020年随着泡沫消散，人们也也更清楚的认识到了AI的局限性，[人工智能](https://index.baidu.com/v2/main/index.html#/trend/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD?words=%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD)其实不是人工的智能，这里的人工实际上是个动词，通过足够的人工操作才能累计出某些领域所谓的智能。泡沫消散的同时也让某些真正有能力有城府的人投入更多的精力进行研究，运用AI为社会创造价值。[微服务](https://index.baidu.com/v2/main/index.html#/trend/%E5%BE%AE%E6%9C%8D%E5%8A%A1?words=%E5%BE%AE%E6%9C%8D%E5%8A%A1)也一样，2017~2018年有些人也以为微服务就是某种[银弹](https://zh.wikipedia.org/wiki/%E6%B2%A1%E6%9C%89%E9%93%B6%E5%BC%B9)，能够解决架构或者团队发展中遇到的瓶颈。

- 这里提出一个比较激进的观点：技术本身是没有经济价值的。

  > ​	我们每天开发的代码服务器上运行的程序不会产生直接的经济价值。但是为什么BOSS每月会给我们发薪水呢，实际上是我们用的技术和工作所干的事挣钱。反过来说的采用某种技术以及使用某种工具，首先应该考虑的是能否提高版本迭代效率，提高应用的稳定性，其次才应该考虑后续的发展和扩展性。

  在创业初期，开发的应用需要快速实现功能需求，如果在系统应用还未完善的阶段采用复杂的架构往往会降低开发和运维效率。但是随着企业的发展，用户规模的增加，开发测试人员的扩充。这时就会发现代码中盘根错节的依赖关系，正在拖慢版本迭代速度，降低应用稳定性。

- 在2020年我们来谈微服务，实际上不是说该不该了解微服务，因为稍微复杂一些的系统都可以看到一些微服务的影子。我们更多的讨论应该放在何时引入微服务，以及如何根据自身的业务特性去思考微服务能否在某些方面提升效率和质量，以及引入之后带来的提升能否大于所产生的代价。

- 其次要考虑的是人为因素，因为在转型过程之中通常可以概况为三个阶段。

  1. 走出舒适区会感到不适甚至想要退缩 
  2. 新旧概念交替的而过程中为无所适从
  3. 当完全掌握新的概念之后才能体会到新概念带来的种种好处

#### 微服务相关的技术问题有很多

> 微服务好像引入了很多错综复杂的新概念，不知不觉中让人望而生畏。

1. RPC
2. 注册中心
3. 配置中心
4. 事件/消息总线
5. 服务降级和熔断
6. 微服务网关
7. 服务容器化

**我们试图从中找出一些共性并尝试理出一条暗线**

1. 引入的技术是为了解决什么问题
2. 是不是真的有必要解决这个问题
3. 新技术是如何解决问题的
4. 解决问题的同时会不会引入其他问题
5. 如何规避或者降低引入问题的风险

### 在谈论问题之前如何达成一定的共识

> ​	生活中人与人之间的交流其实充满了很多的潜台词，比如说：有同事问我*百家湖新开的海底捞怎么样？*。这句话实际上包含了很多信息：大家都知道海底捞是火锅而不是烧烤，我们也大概是知道百家湖是个商圈和它的大概位置。生活中肯定也会存在很多因为无法理解彼此潜台词而造成讨论了半天，结果是鸡同鸭讲，浪费了很多时间也没有实质性的收获。

​	当我们讨论一个新的技术概念的时候可能会造成更多的误解，所以在讨论之前我们试图能够达成某种共识，比如我们在讨论服务单体泥潭之前我们应该理解单体应用随着版本的迭代会产生一些问题，在讨论服务拆分之前我们要能够尝试理解服务拆分的必要性，以及为什么服务需要拥有独立的数据库。我们会一直采用上文对一系列技术暗线的总结，在讨论具体技术之前达成一定的共识或者能够从某种角度理解这些新的概念。

